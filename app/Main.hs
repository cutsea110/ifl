module Main where

import System.Environment (getArgs)
import System.IO (getContents)

-- import Template.Mark1 (parse, compile, eval, showResults)
-- import Template.Mark2 (parse, compile, eval, showResults)
-- import Template.Mark3 (parse, compile, eval, showResults)
import Template.Mark4 (parse, compile, eval, showResults)

exec :: String -> IO ()
exec = putStrLn . showResults . eval . compile . parse

printHelp :: IO ()
printHelp = do
  -- This banner generated by using 'figlet -f slant IFL'
  putStr $ unlines [ "    ____________"
                   , "   /  _/ ____/ /"
                   , "   / // /_  / /"
                   , " _/ // __/ / /___"
                   , "/___/_/   /_____/ Implimenting Functional Languages"
                   , ""
                   , "> cabal v2-run ifl <file-path>"
                   ]

run :: FilePath -> IO ()
run file = do
  putStrLn $ "Program Source: " ++ file
  testProg <- readFile file
  -- compile and eval program
  exec testProg

main :: IO ()
main = do
  args <- getArgs
  if null args then printHelp
    else run (head args)
